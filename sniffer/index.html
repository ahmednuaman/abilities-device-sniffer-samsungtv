<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>abilities-device-sniffer-samsungtv</title>
		<script src="$MANAGER_WIDGET/Common/af/2.0.0/loader.js"></script>
		<script src="app/javascript/Main.js"></script>
	</head>
	<body onload="initTest()">
        <form action="http://www.ahmednuaman.com/_/abilities/index.php" id="test-form" method="post">
            <input type="text" id="test-device-id" name="device_id">
            <input type="hidden" name="autorun" id="test-autorun" value="1">
        </form>
        <script>
        	function findKey(list, value)
        	{
        	    var key;

        	    for (key in list)
        	    {
        	        if (list[key] === value)
        	        {
        	            return key;
        	        }
        	    }
        	}

        	function initTest()
        	{
                var frame = document.getElementById('test-frame');
        	    var form = document.getElementById('test-form');
        	    var input = document.getElementById('test-device-id');
        	    var deviceId;

        	    if (deviceapis)
        	    {
        	        // ermagad
        	        deviceId = findKey(deviceapis.tv.info, deviceapis.tv.info.getProduct()) + '; ' +
        	            deviceapis.platform + '; ' +
        	            deviceapis.tv.info.getDeviceID() + '; ' +
        	            deviceapis.tv.info.getModel() + '; ' +
        	            deviceapis.tv.info.getFirmware() + '; ' +
        	            deviceapis.tv.info.getCountry() + '; ' +
        	            deviceapis.tv.info.getLanguage() + '; ' +
        	            deviceapis.tv.info.getVersion() + '; ' +
        	            findKey(deviceapis.displaycontrol, deviceapis.displaycontrol.get3DEffectMode()) + '; ' +
        	            findKey(deviceapis.audiocontrol, deviceapis.audiocontrol.getOutputMode());
        	    }
        	    else
        	    {
        	        return alert('Failed to get device!');
        	    }

                frame.height = window.innerHeight;

        	    input.value = deviceId;

        	    form.submit();
        	}
        </script>
	</body>
</html>
